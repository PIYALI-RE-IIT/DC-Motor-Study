<!-- This HTML page and script files are developed by
    Piyali Chattopadhyay
    Project Scientist-Technical,
    Virtual Labs IIT Kharagpur.-->

<!DOCTYPE html>
<html lang="en"><!--html tag start-->
<head>
    <title>Study of DC Motor</title>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="../css/adik.css" rel="stylesheet">
  
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.1/dist/js/bootstrap.bundle.min.js"></script>
  <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.1/themes/base/jquery-ui.css">
  
  <script src="https://code.jquery.com/jquery-1.12.4.js"></script>
  <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.js"></script>
  <script  src="./js/DC.js"></script>
  <!-- <script  src="./js/DC_MOTOR_STUDY.js"</script> -->
  
	
 <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.2.1/math.js"></script>
  <script src=" https://cdnjs.cloudflare.com/ajax/libs/mathjs/11.2.1/math.min.js  "></script>
 
 

<script src="https://canvasjs.com/assets/script/canvasjs.min.js"> </script>


<link rel="stylesheet" href="./css/demo.css">
<link rel="stylesheet" href="./css/DC.css">

	


  <style>
	.dial {
	
position:absolute;
    border: 2px solid #060808;
    border-radius:50%;
    background-color:#060808;
    background-image:linear-gradient(90deg,#060808,#3A3B3B);
	
	box-shadow: 5px 5px 8px #D9DBDB;
}

.dialhandle {
	
position:absolute;
cursor:pointer;
background-color: #11B8C9;
  animation: glow 1s ease-in-out infinite alternate;
}
@-webkit-keyframes glow {
  from {
    text-shadow:  0 0 20px #fff, 0 0 30px #0867DF;
  }
  
  to {
    text-shadow: 0 0 20px #fff, 0 0 30px #023474;
  }
}

.fontCSS{
font-family:'Bodoni MT';
font-style: italic;
}	
	
	
	
	
  </style>
  
  
  
</head>
<body><!--body tag start-->
    <div class="container p-3 my-3 text-primary text-center border"><!--First Container under body tag start-->
        <div class="row"><!--First row under 1st container start-->
            <div class="col-md-3"><!--First col under 1st row start-->
                <img class="img-fluid rounded" src="./images/vlabs.png" alt="VLabs logo">
            </div><!--First col under 1st row end-->
            <div class="col-md-6"><!--2nd col under 1st row start-->
                <p class="display-1"> <b> Virtual Labs <br> IIT Kharagpur </b> </p>
            </div><!--2nd col under 1st row end-->
            <div class="col-md-3"><!--3rd col under 1st row start-->
                <img class="img-fluid rounded" src="./images/iitkgp.png" alt="IIT KGP Logo" >
            </div><!--3rd col under 1st row end-->
        </div><!--First row under 1st container end-->
    
        <hr>
        <div class="row"><!--2nd row under 1st container start-->
            <div class="col-md-3"><!--First col under 2nd row start-->

            </div><!--First col under 2nd row end-->
            <div class="col-md-6"><!--2nd col under 2nd row start-->
                <p class="h1"> <b>Simulation</b> </p>
            </div><!--2nd col under 2nd row end-->
            <div class="col-md-3"><!--3rd col under 2nd row start-->

            </div><!--3rd col under 2nd row end-->
        </div><!--2nd row under 1st container end-->
        <hr>
        
    </div><!--First Container under body tag end-->
    
	
    <div class="container p-3 my-5 text-left border"><!--3rd Container under body tag start-->
      <div class="row"><!--First row under 3rd container start-->
        <div class="col-md-1"></div><!--First col under 3rd container start& end-->
        <div class="col-md-10"><!--2nd col under 3rd container start-->
            <p class="text-center bg-success"> <a class="nav-link" data-bs-toggle="tab"  id="instcontrol" style="background-color:#128BD9"  ><span class=" h3 text-dark"> Instructions </span></a>
              <div id="inst" style="display:block;height:200px;overflow-y:auto;text-align:justify">
			  <ol>
					<b style="color:blue;text-align:center">Motor and Generator Characteristics</b><br>
                      <li>First click on "Tests" button and click on 'No Load' to perform the experiment for finding the dc motor and generator characteristics.</li></br>
  
					  <li>Click on 'ON' button to switch on the motor unit. Connect (blue dots for wire connection) 1-3, 
					set 'MOTOR' switch to 'ON' by clicking on it. Set the 'RESET' switch to 'RESET'. Set load to 0 value. </li><br/>
					 
					 <li>Apply armature voltage E<sub>a</sub> through knob1 (start with 3 volts). Click on 'Simulate' button. Observe motor armature current (mA), speed (rpm). Now click on the
						connected wire (1-3) to delete that and connect 2-3 , click on 'Simulate' button. Observe generator voltage E<sub>g</sub>.
						Click on 'Table' button to get the observation table.</li></br>
						
					<li>Delete connection 2-3 and again connect 1-3, click on 'Simulate' button. Increase the armature voltage to 4 volts and follow
					step 3.</li><br/> 

					 <li> Vary E<sub>a</sub> from 5 - 12 volts and follow step 3.
					 Now Click on 'Plot' button, then on 'Speed (N) Vs. Motor armature voltage (E<sub>a</sub>)'. From a slope of the plot
					 calculate motor constant <span class="fontCSS">K<sub>M</sub></span> (rpm/volts) (calculation explained in theory). 

					 Again click on 'Generator voltage (E<sub>g</sub>) Vs. Speed (N)' under plot button. From a slope of this plot
					 calculate generator constant <span class="fontCSS">K<sub>G</sub></span> (volts/rpm) (calculation explained in theory). 
					 
					 Plots can be downloaded by clicking on 'Download Plot' button. Now enter the values of <span class="fontCSS">K<sub>M</sub></span>
					 and <span class="fontCSS">K<sub>G</sub></span> in the corresponding box under 'Result Block'.
					 
					<li>Bring back all the knobs to zero value. Set 'MOTOR' switch to 'OFF' by clicking on it again and switch off the motor unit.</li><br/><br> 
					</ol>
					<ol>
					<b style="color:blue;text-align:center">Torque-Speed Characteristics</b><br>
                      <li>First click on "Tests" button and click on 'Load' to perform the experiment for finding the dc motor torque-speed characteristics.</li></br>
  
					  <li>Click on 'ON' button to switch on the motor unit. Connect 1-3, set 'MOTOR' switch to 'ON' by clicking on it. Set the 'RESET' switch to 'RESET'. Set load to 0 value. </li><br/>
					 
					 <li>Apply armature voltage E<sub>a</sub> through knob1 and set E<sub>a</sub> to 6 volts. Click on 'Simulate' button. Observe motor armature current (mA), speed (rpm). Now click on the
						connected wire (1-3) to delete that and connect 2-3 , click on 'Simulate' button. Observe generator voltage E<sub>g</sub>.
						Click on 'Table' button to get the observation data.</li></br>

					 <li>Set load to 1 through knob3. Delete connection 2-3 and again connect 1-3. Click on 'Simulate' button and follow step 3. Now vary the load from 2 to 5 through knob3 and take observations following step 3. 
					 Click on 'Simulate' button each time after a wire connection is made. Click on 'Plot' then click on 'Torque (T<sub>M</sub>) Vs. Speed (N)'.
					Now from a slope of the plot calculate viscous friction coefficient <span class="fontCSS">B</span> (newton-meter/rad/sec) of motor and calculate average value of motor back emf constant <span class="fontCSS">K<sub>b</sub></span>
					(volts/rad/sec) from the observation table. Now enter the values of <span class="fontCSS">B</span> and <span class="fontCSS">K<sub>b</sub></span> in the corresponding box under 'Result Block'.</li><br/> 

					<li>Bring back all the knobs to zero value.
					Follow steps 1-4 for E<sub>a</sub> = 8, 10 and 12 volts. Set 'MOTOR' switch to 'OFF' by clicking on it again and switch off the motor unit.</li><br/><br> 
					</ol>
					<ol>
					<b style="color:blue;text-align:center">Step Response of Motor</b><br>
                      <li>First click on "Tests" button and click on 'Step Response' to perform the experiment for finding the dc motor transfer function.</li></br>
  
					  <li>Click on 'ON' button to switch on the motor unit. Connect 1-3, set 'MOTOR' switch to 'ON' by clicking on it. Set the 'RESET' switch to 'RESET'. Set load to 0 value.</li><br/>
					 
					 <li>Apply armature voltage E<sub>a</sub> through knob1 and set E<sub>a</sub> to 8 volts. Click on 'Simulate' button. Observe motor armature current (mA), speed (rpm). Now click on the
						connected wire (1-3) to delete that and connect 2-3 , click on 'Simulate'. Observe generator voltage E<sub>g</sub></li></br>
						
					<li>Now delete connection 2-3 and connect 4-3 , click on 'Simulate' to observe	E<sub>s</sub> value in DVM. Set E<sub>s</sub> through knob2 to 63.2 &percnt; of E<sub>g</sub> (measured above).</sub></li></br>
						
					<li>Set 'MOTOR' switch to 'OFF'. Set 'RESET' switch to 'READY'. Now set the 'MOTOR' switch to 'ON', click on 'Simulate' and observe the 'Time Constant (msec)'.</li><br/>
					
					 <li>Click on 'Table' to get the observation data. Observe the step response. Now find the motor inertia <span class="fontCSS">J</span> using
					 the values of <span class="fontCSS">B, K<sub>b</sub></span> (calculated before) and <span class="fontCSS">&tau;<sub>m</sub></span> from observation table following the formula provided in 'Result Block'.
					 Now enter the value of <span class="fontCSS">J</span> in corresponding box under 'Result Block'.
					 Click on 'Show Transfer Function' button to get the transfer function of the motor.</li><br/> 

					<li> Bring back all the knobs to zero value. Follow steps (1-6) for E<sub>a</sub>= 10 and 12 volts. Set 'MOTOR' switch to 'OFF' and switch off the motor unit..
					</li><br/><br> 
					</ol>
						 
		   </div>
            </p> 
          </div><!--2nd col under 3rd container end-->
		  
        <div class="col-md-1"></div><!--3rd col under 3rd container start& end-->
      </div><!--First row under 3rd container end-->
    </div><!--3rd Container under body tag end-->
	
    <div class="container p-3 my-5 text-center border" id="canvas" ><!--Fourth container under body tag start-->
	
	
		<div class="row my-5 gy-2"><!--- 1st row under fourth container start--->			
        
			<div class="col-md-12" ><!--1st col under 1st row start -->
				  <!-- Code Start here--> 
				<div class="img-container"><!--img container div start-->
				
					<div id="bd1"></div>
					<span style="position:absolute;top:50%;left:20%;color:red">1</span>
					
					<div id="bd2"></div>
					<span style="position:absolute;top:40%;left:61%;color:red">2</span>
					
					<div id="bd3"></div>
					<span style="position:absolute;top:22%;left:75%;color:red">3</span>
					
					<div id="bd4"></div>
					<span style="position:absolute;top:77%;left:65%;color:red">4</span>
					
					<div id="bd5"></div>
				
					<img class="img-fluid " id="plant" src="images/Plant.png " />					
					
					
					<img class="img-fluid " id="mon" onclick="motoron()" src="images/off.png " />
					<img class="img-fluid " id="pon" onclick="planton()" src="images/off.png " />
					<img class="img-fluid " id="rr" onclick="rron()" src="images/off.png " />				
					
					
					<input type="number" id="motor_arm_current" value="0"  readonly="readonly">
					<input type="number" id="motor_arm_voltage" value="0" min="0" max="12"  readonly="readonly">
					<input type="number" id="Es" min="0" value="0" max="10" step="0.1" style="display:none;position:absolute;width:12%;
					height:11%;top:11%;left:79%;text-align:center; background-color: black;color:red;">
					<input type="number" id="motor_tau" value="0"  readonly="readonly">
					
					<input type="number" id="Eg" value="0" style="visibility: hidden;position: absolute;width: 8%;height: 5%;top: 40%;left: 58%;text-align: center;background: transparent;border: none;">
					
					
					<!---knob 1 1st col 1st row--------->
					<!-- <div class="bluedot" id="knob1" style=" width:9%;height:18%;top:55%;left:13%;pointer-events:none;">
					<div class="handlep" id="knob1p" onclick="rotate1()"style="width:30%;height:30%;top:33%;left:0%;"></div>
					<div class="handlen" id="knob1n"onclick="rotate2()" style="width:30%;height:30%;top:33%;left:70%;"></div>
					--><input type="number" id="Ea" min="0" value="0" max="12" step="1" style="visibility:hidden;position:absolute;width:60%;height:30%;top:60%;left:29%;text-align:center; background: transparent;border:none">
					 
					<div id="knob1" class="dial"  style=" width:9%;height:18%;top:55%;left:13%;pointer-events:none;">
					<div class="dialhandle" style="width:20%;height:5%;top:85%;left:20%;transform:rotate(304deg)"></div>				
					</div>
					
					<!---knob 2 1st col 1st row--------->
					<!-- <div class="bluedot" id="knob2" style=" width:10%;height:20.4%;top:63%;left:69.8%;pointer-events:none;">
					<div class="handlep" id="knob2p" onclick="rotate3()"style="width:30%;height:30%;top:33%;left:0%;"></div>
					<div class="handlen" id="knob2n"onclick="rotate4()" style="width:30%;height:30%;top:33%;left:70%;"></div>
					
					 --><div id="knob2" class="dial"  style=" width:10%;height:20.4%;top:63%;left:69.8%;pointer-events:none;">
						<div class="dialhandle" style="width:20%;height:5%;top:85%;left:20%;transform:rotate(304deg)"></div>				
						</div>
						<input type="number" id="Eschk"  value="0"  style="visibility:hidden;position:absolute;width:60%;height:30%;top:65%;left:29%;text-align:center; background: transparent;border:none">
						
		  
				</div><!--img container div end--><br>			
									
					
					<div class="d-inline-flex p-2">
					
					<div class="dropdown p-1">
					  <button class="btn btn-primary dropdown-toggle" type="button"  data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Tests
					  </button>
					  <div class="dropdown-menu" >
						<a class="dropdown-item" onclick="Tableshow1()">No Load</a>
						<a class="dropdown-item" onclick="Tableshow2()">Load</a>
						<a class="dropdown-item" onclick="Tableshow3()">Step Response</a>
					  </div>
					</div>
					
					<div class="dropdown p-1">
					  <button class="btn btn-primary dropdown-toggle" type="button"  data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
						Plot
					  </button>
					  <div class="dropdown-menu" >
						<a class="dropdown-item" onclick="plot1()">Speed (N) Vs. Motor armature voltage (E<sub>a</sub>)</a>
						<a class="dropdown-item" onclick="plot2()">Generator voltage (E<sub>g</sub>) Vs. Speed (N)</a>
						<a class="dropdown-item" onclick="plot3()">Torque (T<sub>M</sub>) Vs. Speed (N)</a>
					  </div>
					</div>					 			
					
				  <div class="p-1">
				  <button type="button" id="simu" onclick="simulate()"  class="btn btn-success " >Simulate</button>
					<button type="button" onclick="Tabled()"  class="btn btn-primary " >Table</button>
				  <!-- <button type="button" onclick="Result()"  class="btn btn-primary " >Result</button>
				   -->
				  <input type="number" id="testchk" min="1" value="1" max="3" style="visibility:hidden;" ></div></div>					
					
			</div><!---end of 1st col under 1st row--->	
			
        </div><!--1st row under fourth container end-->

 
        
	<div class="row my-5 gy-2"><!--- 2nd row under fourth container start--->
	
		<div class="col-md-2 "></div><!--1st col under 2nd row start and end -->
		
			<div class="col-md-8 "><!--2nd col under 2nd row start -->	
			
				<div class="img-container"><!--img container div start--> 
					  
					<div id="bd6"></div>
					  
					<img class="img-fluid" id="load"  src="./images/loadbox.png "/>	
				
					<input type="number" id="motor_speed" value="0"  readonly="readonly"><br/></br>
						<!---knob 3 1st col 1st row--------->
						<!-- <div class="bluedot" id="knob3" style=" width:31%;height:28%;top:49%;left:33%;pointer-events:none;">
						<div class="handlep" id="knob3p" onclick="rotate5()"style="width:30%;height:30%;top:33%;left:0%;"></div>
						<div class="handlen" id="knob3n"onclick="rotate6()" style="width:30%;height:30%;top:33%;left:70%;"></div>
						 -->
						<div id="knob3" class="dial"  style=" width:31%;height:28%;top:49%;left:33%;pointer-events:none;">
						<div class="dialhandle" style="width:20%;height:5%;top:85%;left:20%;transform:rotate(304deg)"></div>				
						</div>
						<input type="number" id="RL" min="0" value="0" max="5" step="1" style="position:absolute;width:23%;height:5%;top:78%;left:39%;text-align:center; background: transparent;border:none"readonly="readonly">
						
							   
							   </div>
							   
							   <input type="number" id="counterchk" min="1" value="1" max="2" style="visibility:hidden;" >
							
				</div>
		
		<div class="col-md-2 "></div><!--3rd col under 2nd row start and end -->		
			</div><!--- 2nd row under fourth container end--->	
			
			
			<div class="row my-5 gy-2">
	
		<div class="col-md-1 "></div>
        <div class="col-md-10 ">			
		
			<table id="myTable" >
			
				
				  <tr>
					<th>Sl No.</th>
					<th>E<sub>a</sub> (volts)</th> 
					<th>I<sub>a</sub> (mA)</th>
					<th>N (rpm)</th>
					<th>E<sub>g</sub> (volts)</th>					
				  </tr>
				  
			</table>
			
			</div>
			<div class="col-md-1 "></div>
			</div>
			
			<div class="row my-5 gy-2">
	
		<div class="col-md-1 "></div>
        <div class="col-md-10 ">
			<span id="vchkspan" style="display:none"><b>For E<sub>a</sub> =</b> <input type="number" id="vchk" value="0" style="width:10%;text-align:center">&nbsp;<b>V</b></span><br>
			
			<table id="myTableload" style="width:100%">
			
				
				  <tr>
					<th>Sl No.</th>
					<th>Load Step</th> 
					<th>I<sub>a</sub> (mA)</th>
					<th>N (rpm)</th>
					<th>&omega; (rad/s)</th>
					<th>E<sub>b</sub> (volts)</th>
					<th><span class="fontCSS">K<sub>b</sub></span> (volts/rad/s)</th>
					<th>T<sub>M</sub> (newton-meter)</th>
				  </tr>
				  
			</table>
			</div>
			<div class="col-md-1 "></div>
			</div>
			
			
			
			<div class="row my-5 gy-2">
	
		<div class="col-md-1 "></div>
        <div class="col-md-10 ">
			<table id="myTablestep" style="width:100%">
			
				
				  <tr>
					<th>Sl No.</th>
					<th>E<sub>a</sub> (volts)</th> 
					<th>E<sub>g</sub> (volts)</th>
					<th>N (rpm)</th>
					<th>E<sub>s</sub> (volts)</th>
					<th>Time Constant (<span class="fontCSS">&tau;<sub>m</sub></span> (msec))</th>
					<th>Gain Constant (K<sub>M</sub> (&pi; N/30E<sub>a</sub>))</th>
					
				  </tr>
				  
			</table>
			
		</div>
			<div class="col-md-1 "></div>
			</div>
			
			
			
		<div class="row my-5 gy-2">
			<div class="col-md-1"></div>
			<div class="col-md-10">	
	
			
			
			<div id="results" class="card" style="display:block;width:70%;background-color:pink">
			<br/>
			<span class="card-title"><b > Result Block</b></span><br/><br/>
			
			<span  class="card-text"><span class="fontCSS">K<sub>M</sub></span> (Motor Constant) =  <input type="number" id="mconstant" value="0"  style="width:20%;text-align:center" readonly=readonly> rpm/volts<br><br/><!--417.60-->
			
			<span  class="card-text"><span class="fontCSS">K<sub>G</sub></span> (Generator Constant) =  <input type="number" id="gconstant" value="0"  style="width:20%;text-align:center" readonly=readonly> volts/rpm<br/><br/><!-- 0.0021457166 -->
			
			<span  class="card-text"><span class="fontCSS">B</span> (Viscous friction coefficient of Motor) =  <input type="number" id="bconstant" value="0"  style="width:20%;text-align:center" readonly=readonly> newton-meter/rad/sec<br/><br/>
			
			<span  class="card-text"><span class="fontCSS">K<sub>b</sub></span> (Back emf constant of Motor) =  <input type="number" id="kbconstant" value="0"  style="width:20%;text-align:center" readonly=readonly> volts/rad/sec<br/><br/>
			
			<span class="card-text">
			
			$$J = \tau_m (B + \frac{{K_b}^2}{R_a}) \ take \ R_a = 4 \Omega$$
			
			
			</span>
			
			<span class="card-text "><span class="fontCSS">J</span> (Motor inertia) = <input type="number" id="motor_inertia" value="0"  style="text-align:center" readonly=readonly>
			&nbsp;newton-meter/rad/sec<sup>2</sup></span><br/><br/>	

			<button id="tfbtn"class="btn btn-danger" onclick="$('#result_step').css('display','block');" disabled=disabled>Show Transfer Function</button><br/><br/>

			</div>
			
			<!-- <div id="result_load" class="content-center img-container" style="display:none;">
			
			K<sub>b</sub> (Motor back emf constant) = 22.53 &times; 10<sup>-3</sup> volts/rad/sec<br>
			B (viscous friction coefficient of Motor) = 94.83 &times; 10<sup>-6</sup> Newton-meter/rad/sec
			
			</div> -->
			
			<div id="result_step" class="card" style="display:none; width:100%;background-color:none">
			<br/>
			
			<span class="card-text "><b>Motor Transfer Function</b></span><br/><br/><br/>
			
			<!-- = <input type="number" id="tfn" style="position:absolute;width:10%;height:35%;left:65%;top:32%;"readonly="readonly"><hr style="position:absolute;width:17%;left:62%;top:60%"><br><br>
				<span style="position:absolute;left:62%;top:81%">[</span><input type="number" id="tfd" style="position:absolute;width:10%;height:35%;left:63.5%;top:81%;"readonly="readonly"> <span style="position:absolute;left:74%;top:84%"><b>s +1]</b></span>
			 -->
			
			<span class="card-text" ><b style="position:absolute;width: 25%;left:21%;top: 61%;">G<sub>M</sub> (s) =</b> &nbsp;<input  type="number" id="tfn" value="0" readonly=readonly style="position:absolute;left:43%;top:48%;width:15%;text-align:center"></span><br/>
			<br/>
			<span  class="card-text fontCss" >&nbsp;&nbsp;<input type="number" id="tfd" value="0" readonly=readonly style="width:15%;text-align:center">&nbsp;&nbsp;<b>s + 1</b></span>
			<hr  style="position:absolute;width: 25%;left: 38%;top: 59%;">
			<br/><br/>
			</div>
	
			</div>
			<div class="col-md-1"></div>
		</div>
		


	 <div class="row justify-content-center"><!-----------------------graph T vs. w----------------------------------------->
		
	 
			<div class="col-md-12">
				<div id = "plotbucket" class="content-center" style="display:none; position: relative; border:3px solid white;height:530px;width:823px ">
				<button type="button" id="exportChart" class="btn btn-primary"  style="display:none;position:absolute;left:20%;">Download Plot</button>
				<button type="button" id="result" class="btn btn-primary" onclick="Refresh()"  style="display:none;position:absolute;left:35%">OK</button><br/><br/>
					<div id="chartContainer"  style="display:none; position:absolute; height: 50%; width: 40%;z-index:1 "></div>
					<div id="chartContainer2"  style="display:none; position:absolute; height: 50%; width: 40%;z-index:1 "></div>
					<div id="chartContainer3"  style="display:none; position:absolute; height: 50%; width: 40%;z-index:1 "></div>
					<div id="chartContainer4"  style="display:none; position:absolute; height: 50%; width: 40%;z-index:1 "></div>
					
				</div>
				
			</div>
			
			
		
	</div>	

	
	
          <!-- Code End here-->
        </div><!--Fourth container under body tag end-->
          
      <!--</div>
    </div>-->

    <div class="container p-3 my-5 text-primary text-center border"><!--Last and fifth container under body tag start-->
      <div class="row">
        <footer>
          <div class="row ce">
            <div class="col-sm-12">
              <p class="h5"><i> Copyright Â©2022 <a href="http://vlabs.iitkgp.ac.in/vlt/">Virtual Labs IIT Kharagpur</a> </i><br><br>
              <a href="../../license/index.html" target="_blank"> Licensing Terms </a>
            </p>
            </div>
          </div>
        </footer>
      </div>
  </div><!--Last and fifth container under body tag end-->
  
  <script src="./js/jsPlumb.js"></script>	
	<script src="./js/demo.js"> </script> 
	<script>
	var knobPositionX;
      var knobPositionY;
      var mouseX;
      var mouseY;
      var knobCenterX;
      var knobCenterY;
      var adjacentSide;
      var oppositeSide;
      var currentRadiansAngle;
      var getRadiansInDegrees;
      var finalAngleInDegrees;
      var volumeSetting;
      
      var knob1 = document.getElementById("knob1");//Ea knob
	  var knob2 = document.getElementById("knob2");//Es knob
	  var knob3 = document.getElementById("knob3");//load knob
	  
      var boundingRectangle1 = knob1.getBoundingClientRect(); //get rectangular geometric data of knob (x, y, width, height)
	  var boundingRectangle2 = knob2.getBoundingClientRect();
	  var boundingRectangle3 = knob3.getBoundingClientRect();
	 
      function main1()
      {
          knob1.addEventListener(getMouseDown(), onMouseDown1); //listen for mouse button click
          document.addEventListener(getMouseUp(), onMouseUp1); //listen for mouse button release
	  }
	  function main2()
      {
          knob2.addEventListener(getMouseDown(), onMouseDown2); //listen for mouse button click
          document.addEventListener(getMouseUp(), onMouseUp2); //listen for mouse button release
	  }
	  function main3()
      {
          knob3.addEventListener(getMouseDown(), onMouseDown3); //listen for mouse button click
          document.addEventListener(getMouseUp(), onMouseUp3); //listen for mouse button release
	  }
	  
      //on mouse buttons down
      function onMouseDown1()
      {
	  document.addEventListener(getMouseMove(), onMouseMove1); //start drag
      }	  
	  function onMouseDown2()
      {
	  document.addEventListener(getMouseMove(), onMouseMove2); //start drag
      }
	  function onMouseDown3()
      {
	  document.addEventListener(getMouseMove(), onMouseMove3); //start drag
      }
	  
      //on mouse buttons release
      function onMouseUp1()
      {
          document.removeEventListener(getMouseMove(), onMouseMove1); //stop drag
      }
	  function onMouseUp2()
      {
          document.removeEventListener(getMouseMove(), onMouseMove2); //stop drag
      }
	  function onMouseUp3()
      {
          document.removeEventListener(getMouseMove(), onMouseMove3); //stop drag
      }
	  
      //compute mouse angle relative to center of volume knob
      //For clarification, see my basic trig explanation at:
      //https://www.quora.com/What-is-the-significance-of-the-number-pi-to-the-universe/answer/Kevin-Lam-15
      function onMouseMove1(event)
      {	  
          knobPositionX = boundingRectangle1.left; //get knob's global x position
          knobPositionY = boundingRectangle1.top; //get knob's global y position

          if(detectMobile() == "desktop")
          {
              mouseX = event.pageX; //get mouse's x global position
              mouseY = event.pageY; //get mouse's y global position
          } else {
              mouseX = event.touches[0].pageX; //get finger's x global position
              mouseY = event.touches[0].pageY; //get finger's y global position
          }

          knobCenterX = boundingRectangle1.width / 2 + knobPositionX; //get global horizontal center position of knob relative to mouse position
          knobCenterY = boundingRectangle1.height / 2 + knobPositionY; //get global vertical center position of knob relative to mouse position

          adjacentSide = knobCenterX - mouseX; //compute adjacent value of imaginary right angle triangle
          oppositeSide = knobCenterY - mouseY; //compute opposite value of imaginary right angle triangle

          //arc-tangent function returns circular angle in radians
          //use atan2() instead of atan() because atan() returns only 180 degree max (PI radians) but atan2() returns four quadrant's 360 degree max (2PI radians)
          currentRadiansAngle = Math.atan2(adjacentSide, oppositeSide);

          getRadiansInDegrees = currentRadiansAngle * 180 / Math.PI; //convert radians into degrees

          finalAngleInDegrees = -(getRadiansInDegrees - 135); //knob is already starting at -135 degrees due to visual design so 135 degrees needs to be subtracted to compensate for the angle offset, negative value represents clockwise direction

          //only allow rotate if greater than zero degrees or lesser than 270 degrees
          if(finalAngleInDegrees >= 0 && finalAngleInDegrees <= 300)
          {
              knob1.style.transform = "rotate(" + finalAngleInDegrees + "deg)"; //use dynamic CSS transform to rotate volume knob

              //270 degrees maximum freedom of rotation / 100% volume = 1% of volume difference per 2.7 degrees of rotation
              volumeSetting = Math.round(finalAngleInDegrees / (300 / 100));
              var voltValue = volumeSetting * (12/100); 
              document.getElementById("motor_arm_voltage").value = Math.round(voltValue);//+ "%"; //update volume text
			  document.getElementById("Ea").value = Math.round(voltValue);
          }
      }

///knob2/////
function onMouseMove2(event)
      {
          knobPositionX = boundingRectangle2.left; //get knob's global x position
          knobPositionY = boundingRectangle2.top; //get knob's global y position

          if(detectMobile() == "desktop")
          {
              mouseX = event.pageX; //get mouse's x global position
              mouseY = event.pageY; //get mouse's y global position
          } else {
              mouseX = event.touches[0].pageX; //get finger's x global position
              mouseY = event.touches[0].pageY; //get finger's y global position
          }

          knobCenterX = boundingRectangle2.width / 2 + knobPositionX; //get global horizontal center position of knob relative to mouse position
          knobCenterY = boundingRectangle2.height / 2 + knobPositionY; //get global vertical center position of knob relative to mouse position

          adjacentSide = knobCenterX - mouseX; //compute adjacent value of imaginary right angle triangle
          oppositeSide = knobCenterY - mouseY; //compute opposite value of imaginary right angle triangle

          //arc-tangent function returns circular angle in radians
          //use atan2() instead of atan() because atan() returns only 180 degree max (PI radians) but atan2() returns four quadrant's 360 degree max (2PI radians)
          currentRadiansAngle = Math.atan2(adjacentSide, oppositeSide);

          getRadiansInDegrees = currentRadiansAngle * 180 / Math.PI; //convert radians into degrees

          finalAngleInDegrees = -(getRadiansInDegrees - 135); //knob is already starting at -135 degrees due to visual design so 135 degrees needs to be subtracted to compensate for the angle offset, negative value represents clockwise direction

          //only allow rotate if greater than zero degrees or lesser than 270 degrees
          if(finalAngleInDegrees >= 0 && finalAngleInDegrees <= 300)
          {
              knob2.style.transform = "rotate(" + finalAngleInDegrees + "deg)"; //use dynamic CSS transform to rotate volume knob

              //270 degrees maximum freedom of rotation / 100% volume = 1% of volume difference per 2.7 degrees of rotation
              volumeSetting = Math.floor(finalAngleInDegrees / (300 / 100));
				var voltValue = volumeSetting * (10/100); 
              document.getElementById("Es").value = math.floor(voltValue * 10)/10 ;
              
             // document.getElementById("volumeValue").innerHTML = volumeSetting + "%"; //update volume text
          }
      }
	  
	  ///knob3/////
function onMouseMove3(event)
      {
          knobPositionX = boundingRectangle3.left; //get knob's global x position
          knobPositionY = boundingRectangle3.top; //get knob's global y position

          if(detectMobile() == "desktop")
          {
              mouseX = event.pageX; //get mouse's x global position
              mouseY = event.pageY; //get mouse's y global position
          } else {
              mouseX = event.touches[0].pageX; //get finger's x global position
              mouseY = event.touches[0].pageY; //get finger's y global position
          }

          knobCenterX = boundingRectangle3.width / 2 + knobPositionX; //get global horizontal center position of knob relative to mouse position
          knobCenterY = boundingRectangle3.height / 2 + knobPositionY; //get global vertical center position of knob relative to mouse position

          adjacentSide = knobCenterX - mouseX; //compute adjacent value of imaginary right angle triangle
          oppositeSide = knobCenterY - mouseY; //compute opposite value of imaginary right angle triangle

          //arc-tangent function returns circular angle in radians
          //use atan2() instead of atan() because atan() returns only 180 degree max (PI radians) but atan2() returns four quadrant's 360 degree max (2PI radians)
          currentRadiansAngle = Math.atan2(adjacentSide, oppositeSide);

          getRadiansInDegrees = currentRadiansAngle * 180 / Math.PI; //convert radians into degrees

          finalAngleInDegrees = -(getRadiansInDegrees - 135); //knob is already starting at -135 degrees due to visual design so 135 degrees needs to be subtracted to compensate for the angle offset, negative value represents clockwise direction

          //only allow rotate if greater than zero degrees or lesser than 270 degrees
          if(finalAngleInDegrees >= 0 && finalAngleInDegrees <= 300)
          {
              knob3.style.transform = "rotate(" + finalAngleInDegrees + "deg)"; //use dynamic CSS transform to rotate volume knob

              //270 degrees maximum freedom of rotation / 100% volume = 1% of volume difference per 2.7 degrees of rotation
              volumeSetting = Math.floor(finalAngleInDegrees / (300 / 100));
				var voltValue = volumeSetting * (5/100); 
              document.getElementById("RL").value = math.round(voltValue) ;
              
             // document.getElementById("volumeValue").innerHTML = volumeSetting + "%"; //update volume text
          }
      }
	  
	  //detect for mobile devices from https://www.sitepoint.com/navigator-useragent-mobiles-including-ipad/
      function detectMobile()
      {
          var result = (navigator.userAgent.match(/(iphone)|(ipod)|(ipad)|(android)|(blackberry)|(windows phone)|(symbian)/i));

          if(result !== null)
          {
              return "mobile";
          } else {
              return "desktop";
          }
      }

      function getMouseDown()
      {
          if(detectMobile() == "desktop")
          {
              return "mousedown";
          } else {
              return "touchstart";
          }
      }

      function getMouseUp()
      {
          if(detectMobile() == "desktop")
          {
              return "mouseup";
          } else {
              return "touchend";
          }
      }

      function getMouseMove()
      {
          if(detectMobile() == "desktop")
          {
              return "mousemove";
          } else {
              return "touchmove";
          }
      }

      main1();
	  main2();
	  main3();

	</script>
	
</body><!--body tag end-->
</html><!--html tag end-->